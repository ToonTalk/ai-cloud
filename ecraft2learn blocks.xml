<blocks app="Snap! 4.0, http://snap.berkeley.edu" version="1"><block-definition s="Load script %&apos;URL&apos; then %&apos;do when loaded&apos; even if already loaded %&apos;reload&apos;" type="command" category="other"><header></header><code></code><inputs><input type="%txt"></input><input type="%cmdRing"></input><input type="%b"></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>url</l><l>callback</l><l>reload</l></list><l>if (!reload &amp;&amp; window.ecraft2larn_scripts_loaded &amp;&amp; window.ecraft2learn_scripts_loaded.indexOf(url) &gt;= 0) {&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;    if (typeof callback === &apos;object&apos;) {&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;       invoke(callback, new List([]));&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;    };&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;    return;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;}&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;var script = document.createElement("script");&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;script.type = "text/javascript";&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;script.src = url;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;script.addEventListener(&apos;load&apos;, function () {&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;    if (typeof callback === &apos;object&apos;) {&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;       invoke(callback, new List([]));&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;    };&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;    if (window.ecraft2learn_scripts_loaded &amp;&amp; window.ecraft2learn_scripts_loaded.indexOf(url) &lt; 0) {&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;        window.ecraft2learn_scripts_loaded.push(url);&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;    } else {&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;        window.ecraft2learn_scripts_loaded = [url];&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;    }&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;});&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;&#xD;document.head.appendChild(script);</l></block><list><block var="URL"/><block var="do when loaded"/><block var="reload"/></list></block></script></block-definition><block-definition s="Listen for %&apos;duration&apos; seconds then %&apos;handle response&apos; but if error %&apos;handle error&apos;" type="command" category="sensing"><header></header><code></code><inputs><input type="%n"></input><input type="%cmdRing"></input><input type="%cmdRing"></input></inputs><script><custom-block s="Load script %txt then %cmdRing even if already loaded %b"><l>https://toontalk.github.io/ai-cloud/ecraft2learn.js</l><block s="reifyScript"><script><block s="doRun"><block s="reportJSFunction"><list><l>callback</l><l>error_callback</l><l>duration</l></list><l>ecraft2learn.start_microsoft_speech_recognition_batch(callback, error_callback, duration)</l></block><list><block var="handle response"/><block var="handle error"/><block var="duration"/></list></block></script><list></list></block><block s="reportBoolean"><l><bool>true</bool></l></block></custom-block></script></block-definition><block-definition s="Listen %&apos;respond as heard&apos; then finally %&apos;handle response&apos; but if nothing heard %&apos;handle nothing said&apos;" type="command" category="sensing"><header></header><code></code><inputs><input type="%cmdRing"></input><input type="%cmdRing"></input><input type="%cmdRing"></input></inputs><script><custom-block s="Load script %txt then %cmdRing even if already loaded %b"><l>https://toontalk.github.io/ai-cloud/ecraft2learn.js</l><block s="reifyScript"><script><block s="doRun"><block s="reportJSFunction"><list><l>as_recognized_callback</l><l>final_callback</l><l>error_callback</l></list><l>ecraft2learn.start_microsoft_speech_recognition(as_recognized_callback, final_callback, error_callback)</l></block><list><block var="respond as heard"/><block var="handle response"/><block var="handle nothing said"/></list></block></script><list></list></block><block s="reportBoolean"><l><bool>true</bool></l></block></custom-block></script></block-definition></blocks>